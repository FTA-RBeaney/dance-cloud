import{X as e}from"../runtime.mjs";import{v as t,s as r,m as s,o as a,q as n,e as o,f as i,l as c,g as l,i as u,k as d}from"./server.mjs";import{_ as p}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";import"../virtual/_commonjsHelpers.mjs";import"../routes/renderer.mjs";import"../_/pathe.ff20891b.mjs";const h=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function objectHash(e,t){const r=createHasher(t=t?{...h,...t}:h);return r.dispatch(e),r.toString()}const f=Object.freeze(["prototype","__proto__","constructor"]);function createHasher(t){let r="",s=new Map;const write=e=>{r+=e};return{toString:()=>r,getContext:()=>s,dispatch(e){t.replacer&&(e=t.replacer(e));return this[null===e?"null":typeof e](e)},object(r){if(r&&"function"==typeof r.toJSON)return this.object(r.toJSON());const a=Object.prototype.toString.call(r);let n="";const o=a.length;n=o<10?"unknown:["+a+"]":a.slice(8,o-1),n=n.toLowerCase();let i=null;if(void 0!==(i=s.get(r)))return this.dispatch("[CIRCULAR:"+i+"]");if(s.set(r,s.size),void 0!==e&&e.isBuffer&&e.isBuffer(r))return write("buffer:"),write(r.toString("utf8"));if("object"!==n&&"function"!==n&&"asyncfunction"!==n)this[n]?this[n](r):t.ignoreUnknown||this.unkown(r,n);else{let e=Object.keys(r);t.unorderedObjects&&(e=e.sort());let s=[];!1===t.respectType||isNativeFunction(r)||(s=f),t.excludeKeys&&(e=e.filter((e=>!t.excludeKeys(e))),s=s.filter((e=>!t.excludeKeys(e)))),write("object:"+(e.length+s.length)+":");const dispatchForKey=e=>{this.dispatch(e),write(":"),t.excludeValues||this.dispatch(r[e]),write(",")};for(const t of e)dispatchForKey(t);for(const e of s)dispatchForKey(e)}},array(e,r){if(r=void 0===r?!1!==t.unorderedArrays:r,write("array:"+e.length+":"),!r||e.length<=1){for(const t of e)this.dispatch(t);return}const a=new Map,n=e.map((e=>{const r=createHasher(t);r.dispatch(e);for(const[e,t]of r.getContext())a.set(e,t);return r.toString()}));return s=a,n.sort(),this.array(n,!1)},date:e=>write("date:"+e.toJSON()),symbol:e=>write("symbol:"+e.toString()),unkown(e,t){if(write(t),e)return write(":"),e&&"function"==typeof e.entries?this.array(Array.from(e.entries()),!0):void 0},error:e=>write("error:"+e.toString()),boolean:e=>write("bool:"+e),string(e){write("string:"+e.length+":"),write(e)},function(e){write("fn:"),isNativeFunction(e)?this.dispatch("[native]"):this.dispatch(e.toString()),!1!==t.respectFunctionNames&&this.dispatch("function-name:"+String(e.name)),t.respectFunctionProperties&&this.object(e)},number:e=>write("number:"+e),xml:e=>write("xml:"+e.toString()),null:()=>write("Null"),undefined:()=>write("Undefined"),regexp:e=>write("regex:"+e.toString()),uint8array(e){return write("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},uint8clampedarray(e){return write("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},int8array(e){return write("int8array:"),this.dispatch(Array.prototype.slice.call(e))},uint16array(e){return write("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},int16array(e){return write("int16array:"),this.dispatch(Array.prototype.slice.call(e))},uint32array(e){return write("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},int32array(e){return write("int32array:"),this.dispatch(Array.prototype.slice.call(e))},float32array(e){return write("float32array:"),this.dispatch(Array.prototype.slice.call(e))},float64array(e){return write("float64array:"),this.dispatch(Array.prototype.slice.call(e))},arraybuffer(e){return write("arraybuffer:"),this.dispatch(new Uint8Array(e))},url:e=>write("url:"+e.toString()),map(e){write("map:");const r=[...e];return this.array(r,!1!==t.unorderedSets)},set(e){write("set:");const r=[...e];return this.array(r,!1!==t.unorderedSets)},file(e){return write("file:"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},blob(){if(t.ignoreUnknown)return write("[blob]");throw new Error('Hashing Blob objects is currently not supported\nUse "options.replacer" or "options.ignoreUnknown"\n')},domwindow:()=>write("domwindow"),bigint:e=>write("bigint:"+e.toString()),process:()=>write("process"),timer:()=>write("timer"),pipe:()=>write("pipe"),tcp:()=>write("tcp"),udp:()=>write("udp"),tty:()=>write("tty"),statwatcher:()=>write("statwatcher"),securecontext:()=>write("securecontext"),connection:()=>write("connection"),zlib:()=>write("zlib"),context:()=>write("context"),nodescript:()=>write("nodescript"),httpparser:()=>write("httpparser"),dataview:()=>write("dataview"),signal:()=>write("signal"),fsevent:()=>write("fsevent"),tlswrap:()=>write("tlswrap")}}const y="[native code] }",m=y.length;function isNativeFunction(e){return"function"==typeof e&&Function.prototype.toString.call(e).slice(-m)===y}class WordArray{constructor(e,t){e=this.words=e||[],this.sigBytes=void 0===t?4*e.length:t}toString(e){return(e||g).stringify(this)}concat(e){if(this.clamp(),this.sigBytes%4)for(let t=0;t<e.sigBytes;t++){const r=e.words[t>>>2]>>>24-t%4*8&255;this.words[this.sigBytes+t>>>2]|=r<<24-(this.sigBytes+t)%4*8}else for(let t=0;t<e.sigBytes;t+=4)this.words[this.sigBytes+t>>>2]=e.words[t>>>2];return this.sigBytes+=e.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new WordArray([...this.words])}}const g={stringify(e){const t=[];for(let r=0;r<e.sigBytes;r++){const s=e.words[r>>>2]>>>24-r%4*8&255;t.push((s>>>4).toString(16),(15&s).toString(16))}return t.join("")}},v={stringify(e){const t=[];for(let r=0;r<e.sigBytes;r+=3){const s=(e.words[r>>>2]>>>24-r%4*8&255)<<16|(e.words[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|e.words[r+2>>>2]>>>24-(r+2)%4*8&255;for(let a=0;a<4&&8*r+6*a<8*e.sigBytes;a++)t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(s>>>6*(3-a)&63))}return t.join("")}},_={parse(e){const t=e.length,r=[];for(let s=0;s<t;s++)r[s>>>2]|=(255&e.charCodeAt(s))<<24-s%4*8;return new WordArray(r,t)}},w={parse:e=>_.parse(unescape(encodeURIComponent(e)))};class BufferedBlockAlgorithm{constructor(){this._data=new WordArray,this._nDataBytes=0,this._minBufferSize=0,this.blockSize=16}reset(){this._data=new WordArray,this._nDataBytes=0}_append(e){"string"==typeof e&&(e=w.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_doProcessBlock(e,t){}_process(e){let t,r=this._data.sigBytes/(4*this.blockSize);r=e?Math.ceil(r):Math.max((0|r)-this._minBufferSize,0);const s=r*this.blockSize,a=Math.min(4*s,this._data.sigBytes);if(s){for(let e=0;e<s;e+=this.blockSize)this._doProcessBlock(this._data.words,e);t=this._data.words.splice(0,s),this._data.sigBytes-=a}return new WordArray(t,a)}}class Hasher extends BufferedBlockAlgorithm{update(e){return this._append(e),this._process(),this}finalize(e){e&&this._append(e)}}const b=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],x=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],S=[];class SHA256 extends Hasher{constructor(){super(...arguments),this._hash=new WordArray([...b])}reset(){super.reset(),this._hash=new WordArray([...b])}_doProcessBlock(e,t){const r=this._hash.words;let s=r[0],a=r[1],n=r[2],o=r[3],i=r[4],c=r[5],l=r[6],u=r[7];for(let r=0;r<64;r++){if(r<16)S[r]=0|e[t+r];else{const e=S[r-15],t=(e<<25|e>>>7)^(e<<14|e>>>18)^e>>>3,s=S[r-2],a=(s<<15|s>>>17)^(s<<13|s>>>19)^s>>>10;S[r]=t+S[r-7]+a+S[r-16]}const d=s&a^s&n^a&n,p=(s<<30|s>>>2)^(s<<19|s>>>13)^(s<<10|s>>>22),h=u+((i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25))+(i&c^~i&l)+x[r]+S[r];u=l,l=c,c=i,i=o+h|0,o=n,n=a,a=s,s=h+(p+d)|0}r[0]=r[0]+s|0,r[1]=r[1]+a|0,r[2]=r[2]+n|0,r[3]=r[3]+o|0,r[4]=r[4]+i|0,r[5]=r[5]+c|0,r[6]=r[6]+l|0,r[7]=r[7]+u|0}finalize(e){super.finalize(e);const t=8*this._nDataBytes,r=8*this._data.sigBytes;return this._data.words[r>>>5]|=128<<24-r%32,this._data.words[14+(r+64>>>9<<4)]=Math.floor(t/4294967296),this._data.words[15+(r+64>>>9<<4)]=t,this._data.sigBytes=4*this._data.words.length,this._process(),this._hash}}function hash(e,t={}){const r="string"==typeof e?e:objectHash(e,t);return(s=r,(new SHA256).finalize(s).toString(v)).slice(0,10);var s}function useRequestFetch(){var e;return(null==(e=function(e=l()){var t;return null==(t=e.ssrContext)?void 0:t.event}())?void 0:e.$fetch)||globalThis.$fetch}const isDefer=e=>"defer"===e||!1===e;function useAsyncData(...e){var r,s,a,n,o,i,c,p,h;const f="string"==typeof e[e.length-1]?e.pop():void 0;"string"!=typeof e[0]&&e.unshift(f);let[y,m,g={}]=e;if("string"!=typeof y)throw new TypeError("[nuxt] [asyncData] key must be a string.");if("function"!=typeof m)throw new TypeError("[nuxt] [asyncData] handler must be a function.");const v=l(),_=m;g.server=null==(r=g.server)||r,g.default=null!=(s=g.default)?s:()=>u.value,g.getCachedData=null!=(a=g.getCachedData)?a:()=>v.isHydrating?v.payload.data[y]:v.static.data[y],g.lazy=null!=(n=g.lazy)&&n,g.immediate=null==(o=g.immediate)||o,g.deep=null!=(i=g.deep)?i:u.deep,g.dedupe=null!=(c=g.dedupe)?c:"cancel";const hasCachedData=()=>null!=g.getCachedData(y,v);if(!v._asyncData[y]||!g.immediate){null!=(h=v.payload._errors)[y]||(h[y]=u.errorValue);const e=g.deep?t.ref:t.shallowRef;v._asyncData[y]={data:e(null!=(p=g.getCachedData(y,v))?p:g.default()),pending:t.ref(!hasCachedData()),error:t.toRef(v.payload._errors,y),status:t.ref("idle"),_default:g.default}}const w={...v._asyncData[y]};delete w._default,w.refresh=w.execute=(e={})=>{var r;if(v._asyncDataPromises[y]){if(isDefer(null!=(r=e.dedupe)?r:g.dedupe))return v._asyncDataPromises[y];v._asyncDataPromises[y].cancelled=!0}if((e._initial||v.isHydrating&&!1!==e._initial)&&hasCachedData())return Promise.resolve(g.getCachedData(y,v));w.pending.value=!0,w.status.value="pending";const s=new Promise(((e,t)=>{try{e(_(v))}catch(e){t(e)}})).then((async e=>{if(s.cancelled)return v._asyncDataPromises[y];let t=e;g.transform&&(t=await g.transform(e)),g.pick&&(t=function(e,t){const r={};for(const s of t)r[s]=e[s];return r}(t,g.pick)),v.payload.data[y]=t,w.data.value=t,w.error.value=u.errorValue,w.status.value="success"})).catch((e=>{if(s.cancelled)return v._asyncDataPromises[y];w.error.value=d(e),w.data.value=t.unref(g.default()),w.status.value="error"})).finally((()=>{s.cancelled||(w.pending.value=!1,delete v._asyncDataPromises[y])}));return v._asyncDataPromises[y]=s,v._asyncDataPromises[y]},w.clear=()=>function(e,t){t in e.payload.data&&(e.payload.data[t]=void 0);t in e.payload._errors&&(e.payload._errors[t]=u.errorValue);e._asyncData[t]&&(e._asyncData[t].data.value=e._asyncData[t]._default(),e._asyncData[t].error.value=u.errorValue,e._asyncData[t].pending.value=!1,e._asyncData[t].status.value="idle");t in e._asyncDataPromises&&(e._asyncDataPromises[t]&&(e._asyncDataPromises[t].cancelled=!0),e._asyncDataPromises[t]=void 0)}(v,y);if(!1!==g.server&&v.payload.serverRendered&&g.immediate){const e=w.refresh({_initial:!0});t.getCurrentInstance()?t.onServerPrefetch((()=>e)):v.hook("app:created",(async()=>{await e}))}const b=Promise.resolve(v._asyncDataPromises[y]).then((()=>w));return Object.assign(b,w),b}function useFetch(e,r,s){const[a={},n]="string"==typeof r?[{},r]:[r,s],o=t.computed((()=>t.toValue(e))),i=a.key||hash([n,"string"==typeof o.value?o.value:"",...generateOptionSegments(a)]);if(!i||"string"!=typeof i)throw new TypeError("[nuxt] [useFetch] key must be a string: "+i);if(!e)throw new Error("[nuxt] [useFetch] request is missing.");const l=i===n?"$f"+i:i;if(!a.baseURL&&"string"==typeof o.value&&"/"===o.value[0]&&"/"===o.value[1])throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:u,lazy:d,default:p,transform:h,pick:f,watch:y,immediate:m,getCachedData:g,deep:v,dedupe:_,...w}=a,b=t.reactive({...c,...w,cache:"boolean"==typeof a.cache?void 0:a.cache});let x;return useAsyncData(l,(()=>{var e;null==(e=null==x?void 0:x.abort)||e.call(x),x="undefined"!=typeof AbortController?new AbortController:{};const r=t.toValue(a.timeout);let s;r&&(s=setTimeout((()=>x.abort()),r),x.signal.onabort=()=>clearTimeout(s));let n=a.$fetch||globalThis.$fetch;if(!a.$fetch){"string"==typeof o.value&&"/"===o.value[0]&&(!t.toValue(a.baseURL)||"/"===t.toValue(a.baseURL)[0])&&(n=useRequestFetch())}return n(o.value,{signal:x.signal,...b}).finally((()=>{clearTimeout(s)}))}),{server:u,lazy:d,default:p,transform:h,pick:f,immediate:m,getCachedData:g,deep:v,dedupe:_,watch:!1===y?[]:[b,o,...y||[]]})}function generateOptionSegments(e){var r;const s=[(null==(r=t.toValue(e.method))?void 0:r.toUpperCase())||"GET",t.toValue(e.baseURL)];for(const r of[e.params||e.query]){const e=t.toValue(r);if(!e)continue;const a={};for(const[r,s]of Object.entries(e))a[t.toValue(r)]=t.toValue(s);s.push(a)}return s}const D=t.defineComponent({__name:"ImageGallery",__ssrInlineRender:!0,async setup(e){let n,o;const{data:i,refresh:c}=([n,o]=t.withAsyncContext((()=>useFetch("/api/images","$Nxggt4fPsR"))),n=await n,o(),n);return(e,n,o,c)=>{var l;n(`<div${r(c)}><h3>Images</h3><form><label>Upload an image: <input type="file" name="image" accept="image/jpg,image/png"></label><button type="submit"> Upload </button></form><p>\x3c!--[--\x3e`),s(t.unref(i),(e=>{n(`<img width="200"${a("src",`/images/${e.pathname}`)}${a("alt",e.pathname)}>`)})),n("\x3c!--]--\x3e</p>"),(null==(l=t.unref(i))?void 0:l.length)?n("<p><i>Tip: delete an image by double-clicking on it.</i></p>"):n("\x3c!----\x3e"),n("</div>")}}}),B=D.setup;D.setup=(e,r)=>{const s=t.useSSRContext();return(s.modules||(s.modules=new Set)).add("components/ImageGallery.vue"),B?B(e,r):void 0};const A=t.defineComponent({__name:"RedirectsPanel",__ssrInlineRender:!0,async setup(e){let s,a;const{data:i,refresh:c}=([s,a]=t.withAsyncContext((()=>useFetch("/api/redirects",{transform:e=>({text:Object.entries(e).map((([e,t])=>`${e} ${t}`)).join("\n")})},"$qudnCtMtUq"))),s=await s,a(),s);return(e,s,a,c)=>{s(`<div${r(c)}><h3>Server redirects</h3><form><p><textarea rows="6" placeholder="/from /to (one redirect per line)" style="${n({width:"300px"})}">${o(t.unref(i).text)}</textarea></p><button type="submit"> Save redirects </button></form></div>`)}}}),C=A.setup;A.setup=(e,r)=>{const s=t.useSSRContext();return(s.modules||(s.modules=new Set)).add("components/RedirectsPanel.vue"),C?C(e,r):void 0};const j=t.defineComponent({__name:"MessagesPanel",__ssrInlineRender:!0,async setup(e){let n,i;const{data:c,refresh:l}=([n,i]=t.withAsyncContext((()=>useFetch("/api/messages","$0AMhPWytjY"))),n=await n,i(),n),u=t.ref("");return(e,n,i,l)=>{var d;n(`<div${r(l)}><h3>Messages</h3><form><input${a("value",t.unref(u))} placeholder="Type a message"><button type="submit"> Send </button></form>\x3c!--[--\x3e`),s(t.unref(c),(e=>{n(`<p>${o(e.text)} - ${o(new Date(e.created_at).toLocaleString("fr-FR"))}</p>`)})),n("\x3c!--]--\x3e"),(null==(d=t.unref(c))?void 0:d.length)?n("\x3c!----\x3e"):n("<p> No messages yet </p>"),n("</div>")}}}),P=j.setup;j.setup=(e,r)=>{const s=t.useSSRContext();return(s.modules||(s.modules=new Set)).add("components/MessagesPanel.vue"),P?P(e,r):void 0};const k={};const R=k.setup;k.setup=(e,r)=>{const s=t.useSSRContext();return(s.modules||(s.modules=new Set)).add("pages/index.vue"),R?R(e,r):void 0};const $=p(k,[["ssrRender",function(e,t,s,a){const n=D,o=A,c=j;t(`<main${r(a)}>`),t(i(n,null,null,s)),t(i(o,null,null,s)),t(i(c,null,null,s)),t("</main>")}]]);export{$ as default};
//# sourceMappingURL=index-Dsa6pdo-.mjs.map
